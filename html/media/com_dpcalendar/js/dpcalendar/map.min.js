!function(){"use strict";
/**
   * @package   DPCalendar
   * @author    Digital Peak http://www.digital-peak.com
   * @copyright Copyright (C) 2007 - 2020 Digital Peak. All rights reserved.
   * @license   http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
   */function a(a,e,o){var t=e.latitude,d=e.longitude;if(null!=t&&""!=t){if(null==a.dpmap)return null==a.dpCachedMarkers&&(a.dpCachedMarkers=[]),void a.dpCachedMarkers.push({data:e,dragCallback:o});e.color||(e.color="000000");var p={draggable:null!=o};p.icon=L.divIcon({className:"dp-location-marker",html:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="#'+String(e.color).replace("#","")+'" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"/></svg>',iconSize:[25,30],iconAnchor:[10,35]});var l=L.marker([t,d],p),n=e.description?e.description:e.title;if(n){var r=l.bindPopup(n);l.on("click",(function(a){r.openPopup()}))}o&&l.on("dragend",(function(a){o(a.target.getLatLng().lat,a.target.getLatLng().lng)})),a.dpmap.dpMarkersCluster.addLayer(l),a.dpmap.dpMarkers.push(l),a.dpmap.dpBounds.extend(l.getLatLng());// Zoom out when needed to fit all markers
var s=a.dpmap.getBoundsZoom(a.dpmap.dpBounds);return s<a.dpmap.getZoom()&&a.dpmap.setZoom(s),a.dpmap.panTo(a.dpmap.dpBounds.getCenter()),l}}
/**
   * @package   DPCalendar
   * @author    Digital Peak http://www.digital-peak.com
   * @copyright Copyright (C) 2007 - 2020 Digital Peak. All rights reserved.
   * @license   http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
   */
function e(e){if("undefined"!=typeof L){e.classList.add("dp-map_loading");var o=e.dataset,t=L.map(e,{attributionControl:!0,fullscreenControl:!0,gestureHandling:!0,gestureHandlingOptions:{duration:2e3,text:{touch:Joomla.JText._("COM_DPCALENDAR_LEAFLET_TEXT_TOUCH"),scroll:Joomla.JText._("COM_DPCALENDAR_LEAFLET_TEXT_SCROLL"),scrollMac:Joomla.JText._("COM_DPCALENDAR_LEAFLET_TEXT_SCROLLMAC")}}}).setView([o.latitude?o.latitude:47,o.longitude?o.longitude:4],o.zoom?o.zoom:4);if(t.attributionControl.setPrefix(""),t.attributionControl.addAttribution(Joomla.getOptions("DPCalendar.map.tiles.attribution")),"google"==Joomla.getOptions("DPCalendar.map.tiles.url")){var d=google.maps.MapTypeId.ROADMAP;switch(o.type){case 2:d=google.maps.MapTypeId.SATELLITE;break;case 3:d=google.maps.MapTypeId.HYBRID;break;case 4:d=google.maps.MapTypeId.TERRAIN}var p=L.gridLayer.googleMutant({type:d});p.addTo(t),p.addEventListener("spawned",(function(a){google.maps.event.addListenerOnce(a.mapObject,"idle",(function(){e.classList.remove("dp-map_loading"),e.classList.add("dp-map_loaded")}))}))}else if("mapbox"==Joomla.getOptions("DPCalendar.map.tiles.url")){var l=L.mapboxGL({accessToken:Joomla.getOptions("DPCalendar.map.mapbox.token"),style:"mapbox://styles/mapbox/streets-v11"});l.on("load",(function(){e.classList.remove("dp-map_loading"),e.classList.add("dp-map_loaded")})),t._layersMaxZoom=19,l.addTo(t)}else{var n=L.tileLayer(Joomla.getOptions("DPCalendar.map.tiles.url"));n.on("load",(function(){e.classList.remove("dp-map_loading"),e.classList.add("dp-map_loaded")})),n.addTo(t)}// Marker cluster
return t.dpMarkersCluster=L.markerClusterGroup(),t.addLayer(t.dpMarkersCluster),t.dpBounds=new L.latLngBounds,t.dpMarkers=[],t.dpElement=e,e.dpmap=t,e.dispatchEvent(new CustomEvent("dp-map-loaded")),Array.isArray(e.dpCachedMarkers)&&(e.dpCachedMarkers.forEach((function(o){a(e,o.data,o.dragCallback)})),e.dpCachedMarkers=null),t}}// Set up the maps
/**
   * @package   DPCalendar
   * @author    Digital Peak http://www.digital-peak.com
   * @copyright Copyright (C) 2007 - 2020 Digital Peak. All rights reserved.
   * @license   http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
   */
var o=window.DPCalendar||{};window.DPCalendar=o,o.Map={},o.Map.create=function(o){var t,d=o.dataset;if(d.width&&(o.style.width=d.width),d.height&&(o.style.height=d.height),!localStorage.getItem("DPCalendar.map.load")&&1==o.dataset.askConsent)return(t=o).classList.add("dp-map_consent"),t.textContent=Joomla.JText._("COM_DPCALENDAR_FIELD_CONFIG_INTEGRATION_MAP_CONSENT_INFO_TEXT"),void t.addEventListener("click",(function(){localStorage.setItem("DPCalendar.map.load",!0),t.classList.remove("dp-map_consent"),t.textContent="",e(t)}));var p=["/com_dpcalendar/js/leaflet/leaflet.js","/com_dpcalendar/css/leaflet/leaflet.css"];"google"==Joomla.getOptions("DPCalendar.map.provider")&&p.push("https://maps.googleapis.com/maps/api/js?libraries=places&language="+Joomla.getOptions("DPCalendar.map.google.lang")+"&key="+Joomla.getOptions("DPCalendar.map.google.key")),"mapbox"==Joomla.getOptions("DPCalendar.map.provider")&&(p.push("https://api.tiles.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css"),p.push("https://api.tiles.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js")),loadDPAssets(p,(function(){var t=[];"google"==Joomla.getOptions("DPCalendar.map.provider")&&t.push("/com_dpcalendar/js/leaflet/leaflet-google.js"),"mapbox"==Joomla.getOptions("DPCalendar.map.provider")&&t.push("/com_dpcalendar/js/leaflet/leaflet-mapbox.js"),loadDPAssets(t,(function(){e(o);var t=o.closest(".dp-location");null==t&&(t=o.closest(".dp-locations")),null!=t&&[].slice.call(t.querySelectorAll(".dp-location__details")).forEach((function(e){var t=e.dataset,d=e.parentElement.querySelector(".dp-location__description");!t.description&&d&&(t.description=d.innerHTML),a(o,t)}))}))}))},o.Map.createMarker=a,o.Map.clearMarkers=function(a){if(null!=a&&null!=a.dpmap&&null!=a.dpmap.dpMarkers){a.dpmap.dpMarkers.forEach((function(e){a.dpmap.dpMarkersCluster.removeLayer(e)})),a.dpmap.dpMarkers=[],a.dpmap.dpCachedMarkers=[],a.dpmap.dpBounds=new L.latLngBounds;var e=a.dpmap.dpElement.dataset;a.dpmap.panTo([e.latitude?e.latitude:47,e.longitude?e.longitude:4])}},o.Map.moveMarker=function(a,e,o,t){e&&null!=a.dpmap&&(e.setLatLng([o,t]),a.dpmap.dpBounds=new L.latLngBounds,a.dpmap.dpMarkers.forEach((function(o){a.dpmap.dpBounds.extend(e.getLatLng())})),a.dpmap.panTo(a.dpmap.dpBounds.getCenter()))},o.Map.drawCircle=
/**
   * @package   DPCalendar
   * @author    Digital Peak http://www.digital-peak.com
   * @copyright Copyright (C) 2007 - 2020 Digital Peak. All rights reserved.
   * @license   http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
   */
function(a,e,o,t){null!=a.dpmap&&("mile"==t&&(o*=1.60934),a.dpmap.dpMarkers.push(L.circle([e.latitude,e.longitude],1e3*o).addTo(a.dpmap)),a.dpmap.dpMarkers.push(L.circleMarker([e.latitude,e.longitude],{radius:10,color:"#000000",fillColor:"#000000",fillOpacity:1}).addTo(a.dpmap)),a.dpmap.panTo([e.latitude,e.longitude]))}}();