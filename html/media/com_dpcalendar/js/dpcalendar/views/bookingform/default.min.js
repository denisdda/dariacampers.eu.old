!function(){"use strict";
/**
   * @package   DPCalendar
   * @author    Digital Peak http://www.digital-peak.com
   * @copyright Copyright (C) 2007 - 2020 Digital Peak. All rights reserved.
   * @license   http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
   */function e(){
// Set button state
var e=document.querySelector(".com-dpcalendar-bookingform .dp-button-save");e&&(e.disabled=!t());// Calculate if there are too many tickets selected per event
var o=!1;// Abort when no price calculation is needed
if([].slice.call(document.querySelectorAll(".com-dpcalendar-bookingform .dp-event")).forEach((function(e){var t=0,n=[].slice.call(e.querySelectorAll(".dp-ticket__amount .dp-select"));n.forEach((function(e){return t+=parseInt(e.options[e.selectedIndex].value)})),n.forEach((function(o){t>e.getAttribute("data-ticket-count")&&parseInt(o.options[o.selectedIndex].value)>0?o.classList.add("dp-select_error"):o.classList.remove("dp-select_error")})),t&&(o=!0)})),Joomla.getOptions("DPCalendar.price.url")&&document.querySelector(".dp-price-total__content")){var n=document.querySelector(".com-dpcalendar-bookingform .dp-tax");// Display overbooking error
if(document.querySelectorAll(".com-dpcalendar-bookingform .dp-ticket__amount .dp-select_error").length>0)return document.querySelector(".com-dpcalendar-bookingform .dp-price-total__content").innerHTML="",Joomla.renderMessages({error:[Joomla.JText._("COM_DPCALENDAR_VIEW_BOOKINGFORM_TICKETS_OVERBOOKED_MESSAGE")]}),e.disabled=!0,void(n&&(n.style.display="none"));!o&&e&&(e.disabled=!0),loadDPAssets(["/com_dpcalendar/js/dpcalendar/dpcalendar.js"],(function(){var e=document.querySelector(".com-dpcalendar-bookingform__form"),t=DPCalendar.formToQueryString(e,'input:not([name="task"]), select');DPCalendar.request(Joomla.getOptions("DPCalendar.price.url"),(function(t){var o=Joomla.JText._("COM_DPCALENDAR_VIEW_BOOKINGFORM_TAX_"+(1==t.data.taxinclusive?"IN":"EX")+"CLUSIVE_TEXT"),n=Joomla.JText._("COM_DPCALENDAR_VIEW_BOOKINGFORM_DISCOUNT");Object.keys(t.data.events).map((function(c){var r=e.querySelector('[data-event-id="'+c+'"]');Object.keys(t.data.events[c]).map((function(e){Object.keys(t.data.events[c][e]).map((function(a){var d=t.data.events[c][e][a],i=e.substring(0,e.length-1),l=r.querySelector("[data-"+i+'-price="'+a+'"]');// In markup it is singular
if(l){var s=l.querySelector(".dp-price__live");if(s){var u=l.querySelector(".dp-price__info"),p="";s.innerHTML=d.discount,d.discount!=d.original?(l.querySelector(".dp-price__live").classList.remove("dp-price_hidden"),l.querySelector(".dp-price__original").classList.remove("dp-price_hidden"),l.querySelector(".dp-price__original").innerHTML=d.original,p=n):(l.querySelector(".dp-price__original").classList.add("dp-price_hidden"),u&&u.classList.add("dp-price_hidden")),t.data.tax&&"0.00"!=d.raw&&(p+=(p?"<br>":"")+o),u&&p&&(u.classList.remove("dp-price_hidden"),loadDPAssets(["/com_dpcalendar/js/popper/popper.js"],(function(){loadDPAssets(["/com_dpcalendar/js/tippy/tippy.js","/com_dpcalendar/css/tippy/tippy.css"],(function(){tippy(u,{interactive:!0,delay:100,arrow:!0,content:p,ignoreAttributes:!0,popperOptions:{modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}})}))})))}}}))}))})),document.querySelector(".com-dpcalendar-bookingform .dp-price-total__content").innerHTML=t.data.total,document.querySelector(".com-dpcalendar-bookingform .dp-price-total__content").setAttribute("data-raw",t.data.totalraw);var c=document.querySelector(".com-dpcalendar-bookingform .dp-tax");t.data.tax?(c.style.display="inline-block",c.querySelector(".dp-tax__content").innerHTML=t.data.tax,c.querySelector(".dp-tax__title").innerHTML="("+t.data.taxtitle+")",loadDPAssets(["/com_dpcalendar/js/popper/popper.js"],(function(){loadDPAssets(["/com_dpcalendar/js/tippy/tippy.js","/com_dpcalendar/css/tippy/tippy.css"],(function(){tippy(c.querySelector(".dp-tax__icon"),{interactive:!0,delay:100,arrow:!0,content:o,ignoreAttributes:!0,popperOptions:{modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}})}))}))):c.style.display="none"}),t)}))}}function t(){var e=!0;return[].slice.call(document.querySelectorAll(".com-dpcalendar-bookingform__form .dp-input-term")).forEach((function(t){t.checked||(e=!1)})),e}document.addEventListener("DOMContentLoaded",(function(){[].slice.call(document.querySelectorAll(".dp-booking-series__input input")).forEach((function(t){t.addEventListener("click",(function(){var t=document.getElementById("jform_series0").checked;[].slice.call(document.querySelectorAll(".com-dpcalendar-bookingform__events .dp-event_instance")).forEach((function(e){e.style.display=t?"inherit":"none",e.querySelector("select").value=t?"1":"0"})),e()}))})),[].slice.call(document.querySelectorAll(".dp-ticket__amount .dp-select, .dp-option__amount .dp-select, .dp-field-country .dp-select")).forEach((function(t){t.addEventListener("change",e)}));var o=document.querySelector(".com-dpcalendar-bookingform .dp-button-save");o&&([].slice.call(document.querySelectorAll(".com-dpcalendar-bookingform__form .dp-input-term")).forEach((function(e){e.addEventListener("change",(function(){return o.disabled=!t()}))})),o.disabled=!t()),e(),[].slice.call(document.querySelectorAll(".com-dpcalendar-bookingform__actions .dp-button")).forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault();var c=document.querySelectorAll(".dp-payment-option");if(t()){// If there is one option check it
"save"==e.getAttribute("data-task")&&1==c.length&&(c[0].querySelector(".dp-payment-option__input").checked=!0);// If there is no price check the first option
var r=document.querySelector(".dp-price-total__content");if("save"==e.getAttribute("data-task")&&c.length>0&&r&&0==r.getAttribute("data-raw")&&(c[0].querySelector(".dp-payment-option__input").checked=!0),"save"==e.getAttribute("data-task")&&c.length>1&&!document.querySelectorAll(".dp-payment-option__input:checked").length){var a=document.getElementsByName("adminForm")[0];return a&&!document.formvalidator.isValid(a)||(o&&(o.disabled=!0),DPCalendar.slideToggle(document.querySelector(".com-dpcalendar-bookingform__payment-options")),[].slice.call(document.querySelectorAll(".dp-payment-option")).forEach((function(e){e.addEventListener("click",(function(){e.querySelector(".dp-payment-option__input").checked=!0,Joomla.submitbutton("bookingform.save")}))}))),!1}return Joomla.submitbutton("bookingform."+e.getAttribute("data-task")),!1}}))})),Joomla.submitbutton=function(e){var t=document.getElementsByName("adminForm")[0];t&&(e.indexOf("cancel")>-1||e.indexOf("delete")>-1||document.formvalidator.isValid(t))&&Joomla.submitform(e,t)},[].slice.call(document.querySelectorAll(".com-dpcalendar-bookingform .dp-field-country .dp-select")).forEach((function(e){loadDPAssets(["/com_dpcalendar/js/choices/choices.js","/com_dpcalendar/css/choices/choices.css"],(function(){e._choicejs=new Choices(e,{itemSelectText:"",noChoicesText:"",shouldSortItems:!1,shouldSort:!1,searchResultLimit:30})}))}));var n=document.getElementById("jform_user_id");if(n){var c=function(){document.getElementById("jform_id").value>0||loadDPAssets(["/com_dpcalendar/js/dpcalendar/dpcalendar.js"],(function(){DPCalendar.request("task=booking.mail",(function(e){if(e.success){var t=function(t){if(e.data[t]){var o=document.getElementById("jform_"+t);o&&(o.value=e.data[t])}};t("name"),t("email"),t("province"),t("city"),t("zip"),t("street"),t("number"),t("telephone"),t("latitude"),t("longitude"),e.data.country&&document.getElementById("jform_country")._choicejs._presetChoices.forEach((function(t){t.label==e.data.country&&document.getElementById("jform_country")._choicejs.setChoiceByValue(t.value)}))}}),"ajax=1&id="+document.getElementById("jform_user_id_id").value)}))};n.addEventListener("change",c),window.jQuery&&
// User field doesn't fire native events
window.jQuery(n).change(c)}}))}();